<!DOCTYPE html>
<html lang="ml">

<head>
    <span id="headContainer"></span>
</head>

<body>
    <div class="loader" id="pageLoader">
        <div class="spinner"></div>
    </div>

    <span id="navbarContainer"></span>

    <section class="container py-3">
        <div class="row g-4" id="life-list"> </div>
    </section>

    <span id="footerContainer"></span>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/custom.js"></script>

    <script type="module">
        // Firebase Config from console
        const firebaseConfig = {
            apiKey: "AIzaSyD9CrCyr09c27TBi-yViwyk0l8HN340IHQ",
            authDomain: "isp-db-2330.firebaseapp.com",
            projectId: "isp-db-2330",
            storageBucket: "isp-db-2330.firebasestorage.app",
            messagingSenderId: "466666491726",
            appId: "1:466666491726:web:c5e9649793d8352465581f",
            measurementId: "G-CMDJLRF946"
        };

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener("DOMContentLoaded", async () => {
            document.title = "Life of Muslim";
            const lifeList = document.getElementById("life-list");

            try {
                const q = query(collection(db, "life_of_muslim"), orderBy("id", "asc"));
                const querySnapshot = await getDocs(q);

                querySnapshot.forEach((doc) => {
                    const life = doc.data();
                    if (!life.desc) return;

                    const lifeItem = `
                    <div class="col-md-4">
                        <div class="cat-box d-flex flex-column">
                            <div>
                                <div class="cat-title">${life.icon} ${life.title} | ${life.ml_title}</div>
                                ${life.desc ?? ""}
                            </div>
                            <a href="life-list.html?id=${life.id}" class="btn btn-primary mt-3 mb-0">
                                ‡¥ï‡µÇ‡¥ü‡µÅ‡¥§‡µΩ ‡¥Ö‡¥±‡¥ø‡¥Ø‡µÅ‡¥ï
                            </a>
                        </div>
                    </div>
                `;
                    lifeList.insertAdjacentHTML("beforeend", lifeItem);
                });

            } catch (error) {
                console.error("üî• Error loading data:", error);
                lifeList.innerHTML = `<div class="col-12 text-danger">‡¥°‡¥æ‡¥±‡µç‡¥± ‡¥≤‡µã‡¥°‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥®‡¥æ‡¥ï‡µÅ‡¥®‡µç‡¥®‡¥ø‡¥≤‡µç‡¥≤.</div>`;
            } finally {
                const loader = document.getElementById("pageLoader");
                if (loader) loader.style.display = "none";
            }
        });
    </script>
</body>

</html>